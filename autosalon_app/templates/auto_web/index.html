{% extends 'auto_web/base.html' %}

{% block content %}
<div class="d-flex justify-content-between align-items-center mb-3">
    <h4 class="text-light">Список автомобилей</h4>
    <form method="get" class="d-flex">
        <!-- сохраняем текущие фильтры -->
        {% for key, value in request.GET.items %}
            {% if key != "sort" %}
                <input type="hidden" name="{{ key }}" value="{{ value }}">
            {% endif %}
        {% endfor %}

        <select name="sort" class="form-select bg-dark text-light border-0 me-2" onchange="this.form.submit()">
            <option value="">Сортировка</option>
            <option value="price_asc" {% if request.GET.sort == "price_asc" %}selected{% endif %}>Цена ↑</option>
            <option value="price_desc" {% if request.GET.sort == "price_desc" %}selected{% endif %}>Цена ↓</option>
            <option value="year_asc" {% if request.GET.sort == "year_asc" %}selected{% endif %}>Год ↑</option>
            <option value="year_desc" {% if request.GET.sort == "year_desc" %}selected{% endif %}>Год ↓</option>
            <option value="power_desc" {% if request.GET.sort == "power_desc" %}selected{% endif %}>Мощность ↓</option>
            <option value="power_asc" {% if request.GET.sort == "power_asc" %}selected{% endif %}>Мощность ↑</option>
        </select>
        <button class="btn btn-success">OK</button>
    </form>
</div>
<div class="row">

    <!-- Каталог машин -->
    <div class="col-md-9">
        <div class="row">
            {% for c in car %}
            <div class="col-md-4 mb-4">
                <div class="card bg-black text-light h-100 shadow">
                    <img src="{{ c.photo.url }}" class="card-img-top" alt="{{ c.model_name }}">
                    <div class="card-body">
                        <h5 class="card-title">{{ c.model_name }}</h5>
                        <p class="text-muted">{{ c.car_brand.name }} • {{ c.year_of_issue }}</p>
                        <p class="text-success fw-bold">${{ c.price_dollars }}</p>
                        <a href="{% url 'car_deteil' c.id %}" class="btn btn-outline-success w-100">Подробнее</a>
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
    </div>
</div>
{% endblock %}
